function log(e){console&&console.log(e)}function deg2rad(e){return e*Math.PI/180}function rad2deg(e){return 180*e/Math.PI}var AFTC=AFTC||{};AFTC.THREE=function(){function e(e){switch(e.name.toLowerCase()){case"three setup complete":break;case"show stats":a.show();break;case"hide stats":a.hide()}}function n(){d.showStats&&((a=new Stats).id="stats",a.setMode(0),a.domElement.style.position="absolute",a.domElement.style.left=0,a.domElement.style.top=0,a.domElement.style.zoom=1.2,a.domElement.style.opacity=d.statsOpacity,document.body.appendChild(a.domElement)),r=new THREE.Scene,null!=d.customCamera&&(s=d.customCamera),s||((s=new THREE.PerspectiveCamera(d.fov,window.innerWidth/window.innerHeight,d.cameraNear,d.cameraFar)).position.x=d.cameraInitialPosition.x,s.position.y=d.cameraInitialPosition.y,s.position.z=d.cameraInitialPosition.z,s.lookAt(d.cameraInitialLookAt)),"object"==typeof d.canvas?"CANVAS"==d.canvas.nodeName&&(i=d.canvas):"string"==typeof d.canvas&&(i=document.getElementById(d.canvas)),(l=i?new THREE.WebGLRenderer({canvas:i,antialias:d.antialias}):new THREE.WebGLRenderer({antialias:d.antialias})).setClearColor(new THREE.Color(d.clearColor)),l.setPixelRatio(window.devicePixelRatio),l.setSize(window.innerWidth,window.innerHeight),i||document.body.appendChild(l.domElement),(null!=d.controls||void 0!=d.controls||d.controls)&&(c=d.controls),null!=c&&void 0!=c&&c||1!=d.attachControls||THREE.OrbitControls&&((c=new THREE.OrbitControls(s,l.domElement)).enablePan=!1,c.enableZoom=!0,c.enableDamping=!0,c.minPolarAngle=deg2rad(d.minPolarAngle),c.maxPolarAngle=deg2rad(d.maxPolarAngle),c.dampingFactor=.07,c.rotateSpeed=.07),d.showAxisHelper&&(axisHelper=new THREE.AxisHelper(d.axisHelperSize),r.add(axisHelper)),$(window).resize(function(){t()}),$(window).on("orientationchange",function(){setTimeout(function(){t()},300)}),t(!0),d.attachDefaultRenderer&&w.push(function(){l.render(r,s)}),e({name:"three setup complete"}),requestAnimationFrame(o)}function t(e){window.innerWidth,window.innerHeight;var n,t=!0;d.onResizeSetCameraPosition&&(n=window.innerWidth>window.innerHeight?d.onResizeLandscapeCameraPosition:d.onResizePortraitCameraPosition,(s.position.x<n.x-2||s.position.x>n.x+2)&&(t=!1),(s.position.y<n.y-2||s.position.y>n.y+2)&&(t=!1),(s.position.z<n.z-2||s.position.z>n.z+2)&&(t=!1),1==e?(s.position.x=n.x,s.position.y=n.y,s.position.z=n.z,s.lookAt(d.cameraInitialLookAt),log("camera-init")):t||TweenMax.to(s.position,.75,{delay:.2,x:n.x,y:n.y,z:n.z,onUpdate:function(){}})),s.aspect=window.innerWidth/window.innerHeight,l.setSize(window.innerWidth,window.innerHeight),s.updateProjectionMatrix()}function o(){a&&a.update(),c&&null!=c&&void 0!=c&&c.enableDamping&&c.update();var e=Date.now();w.forEach(function(n){n(e,e-m)}),m=e,p+=.01,requestAnimationFrame(o)}var i,a,r,s,l,c,d={antialias:!0,clearColor:0,showStats:!0,statsOpacity:.65,showAxisHelper:!1,axisHelperSize:10,cameraInitialPosition:new THREE.Vector3(0,0,20),cameraInitialLookAt:new THREE.Vector3(0,0,0),onResizeSetCameraPosition:!1,onResizePortraitCameraPosition:new THREE.Vector3(0,0,20),onResizeLandscapeCameraPosition:new THREE.Vector3(0,0,50),minPolarAngle:15,maxPolarAngle:155,customCamera:null,cameraNear:.01,cameraFar:1e3,fov:60,controls:null,attachControls:!0,attachDefaultRenderer:!0},m=Date.now(),u={},w=[],h=new THREE.Clock,p=0;if(arguments[0]&&"object"==typeof arguments[0])for(var f in arguments[0])arguments[0].hasOwnProperty(f)?d[f]=arguments[0][f]:console&&console.error&&console.error("AFTC.THREE: ERROR: Unknown paramater: ["+f+"]");this.addToRenderStack=function(e){w.push(e)},this.extend=function(e){e(this)},this.getScene=function(){return r},this.setScene=function(e){r=e},this.getCamera=function(){return s},this.setCamera=function(e){s=e},this.getRenderer=function(){return l},this.setRenderer=function(e){l=e},this.getControls=function(){return c},this.setControls=function(e){c=e},this.getParams=function(){return d},this.getSceneParams=function(){return u},this.getClock=function(){return h},this.getTime=function(){return p},this.getStats=function(){return a},this.credits=function(){log("app.credits()"),log("\tAuthor: Darcey@AllForTheCode.co.uk")},Detector.webgl?($("#no-webgl").hide(),n()):(Detector.addGetWebGLMessage(),log(Detector),$("#no-webgl").show())};